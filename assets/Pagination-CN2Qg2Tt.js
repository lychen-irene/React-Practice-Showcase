import{j as e,r as j}from"./all-DAGqaRkU.js";import{a as x}from"./ProductsLoading-Cp4VV3v3.js";const $=function({openProductModal:r,INITIAL_TEMPLATE_PRODUCT_DATA:d}){return e.jsx("div",{className:"text-end mt-4",children:e.jsx("button",{className:"btn btn-primary mb-5",type:"button",onClick:()=>r("create",d.data),children:"建立新的產品"})})},V=function({products:r,openProductModal:d}){return e.jsxs(e.Fragment,{children:[e.jsx("thead",{className:"",children:e.jsxs("tr",{children:[e.jsx("th",{children:"產品名稱"}),e.jsx("th",{children:"原價"}),e.jsx("th",{children:"售價"}),e.jsx("th",{children:"是否啟用"}),e.jsx("th",{children:"查看細節"})]})}),e.jsx("tbody",{children:r.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"align-middle",children:t.title}),e.jsx("td",{className:"align-middle",children:t.origin_price}),e.jsx("td",{className:"align-middle",children:t.price}),e.jsx("td",{className:`align-middle ${t.is_enabled?"":"text-secondary"}`,children:t.is_enabled?"已啟用":"未啟用"}),e.jsx("td",{className:"align-middle",children:e.jsxs("div",{className:"btn-group",role:"group","aria-label":"Basic example",children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>d("edit",t),children:"編輯"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>d("delete",t),children:"刪除"})]})})]},t.id))})]})},b="https://ec-course-api.hexschool.io/v2",u="eirene09",I=function({modalType:r,productModalRef:d,templateProductData:t,closeProductModal:n,setIsProductsLoading:o,getProducts:m,Toast:a}){return e.jsx("div",{className:"modal fade",id:"productModal",tabIndex:"-1","aria-labelledby":"productModal","aria-hidden":"true",ref:d,children:e.jsx(F,{modalType:r,templateProductData:t,closeProductModal:n,setIsProductsLoading:o,getProducts:m,Toast:a})})},F=function({modalType:r,templateProductData:d,closeProductModal:t,setIsProductsLoading:n,getProducts:o,Toast:m}){const[a,p]=j.useState(d);j.useEffect(function(){p(d)},[d]);const g=async function(s,l=!0){l&&n(!0);const c={data:{...a,origin_price:Number(a.origin_price),price:Number(a.price),rate:Number(a.rate),imagesUrl:[...a.imagesUrl.filter(i=>i!=="")]}};if(r==="create")try{const i=await x.post(`${b}/api/${u}/admin/product`,c);await o(!1),m.fire({icon:"success",title:"Create a new product successfully"})}catch{m.fire({icon:"error",title:"Fail to create a new product"})}finally{n(!1),t()}else try{const i=await x.put(`${b}/api/${u}/admin/product/${s}`,c);await o(!1),m.fire({icon:"success",title:"Update product successfully"})}catch{m.fire({icon:"error",title:"Fail to update product"})}finally{n(!1),t()}},h=function(s){const{name:l,value:c,checked:i,type:f}=s.target;p(function(w){return{...w,[l]:f==="checkbox"?i:c}})},N=function(s,l){p(function(c){const i=[...c.imagesUrl];return i[s]=l,l!==""&&s===i.length-1&&i.length<5&&i.push(""),l===""&&i.length>1&&i[i.length-1]===""&&i.pop(),{...c,imagesUrl:i}})},y=()=>{p(function(s){const l=[...s.imagesUrl];return l.push(""),{...s,imagesUrl:l}})},v=async function(s,l=!0){l&&n(!0);try{const c=await x.delete(`${b}/api/${u}/admin/product/${s}`);await o(!1),m.fire({icon:"success",title:"Delete product successfully"})}catch{m.fire({icon:"error",title:"Fail to delete product"})}finally{n(!1),t()}},C=()=>{p(function(s){const l=[...s.imagesUrl];return l.pop(),{...s,imagesUrl:l}})},k=async function(s){const l=s.target.files?.[0];if(!l){m.fire({icon:"error",title:"No file is selected"});return}try{const c=new FormData;c.append("file-to-upload",l);const i=await x.post(`${b}/api/${u}/admin/upload`,c);p(function(f){return{...f,imageUrl:i.data.imageUrl}})}catch{m.fire({icon:"error",title:"Failed to upload the file"})}};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"modal-dialog modal-xl",children:e.jsxs("div",{className:"modal-content border-0",children:[e.jsxs("div",{className:`modal-header text-white 
            bg-${r==="delete"?"danger":"black"}`,children:[e.jsx("h5",{id:"productModalLabel",className:"modal-title",children:r==="create"?e.jsx("span",{children:"新增產品"}):r==="edit"?e.jsx("span",{children:"編輯產品"}):e.jsx("span",{children:"刪除產品"})}),e.jsx("button",{type:"button",className:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsx("div",{className:"modal-body bg-black text-white text-start",children:r==="delete"?e.jsxs("p",{className:"fs-4",children:["確定要刪除",e.jsxs("span",{className:"text-red",children:[" ",a.title," "]}),"嗎？"]}):e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-sm-4",children:[e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"file-to-upload",className:"form-label",children:"選擇上傳圖片"}),e.jsx("input",{className:"form-control",type:"file",name:"file-to-upload",id:"file-to-upload",accept:".jpg, .jpeg, .png",onChange:s=>k(s)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"imageUrl",className:"form-label",children:"輸入圖片網址"}),e.jsx("input",{type:"text",id:"imageUrl",name:"imageUrl",className:"form-control",placeholder:"請輸入圖片連結",defaultValue:a.imageUrl,onChange:h})]}),a.imageUrl&&e.jsx("img",{className:"img-fluid",src:a.imageUrl,alt:"主圖",referrerPolicy:"no-referrer"})]}),e.jsxs("div",{children:[a.imagesUrl.map(function(s,l){return e.jsxs("div",{children:[e.jsx("label",{htmlFor:"imageUrl",className:"form-label",children:"輸入圖片網址"}),e.jsx("input",{type:"text",className:"form-control",placeholder:`圖片網址${l+1}`,defaultValue:s,onChange:c=>N(l,c.target.value)}),s&&e.jsx("img",{className:"img-fluid",src:s,alt:`副圖${l+1}`,referrerPolicy:"no-referrer"})]},l)}),e.jsx("button",{className:"btn btn-primary btn-sm d-block w-100 mt-2",onClick:y,children:"新增圖片"})]}),e.jsx("div",{children:e.jsx("button",{className:"btn btn-danger btn-sm d-block w-100 mt-2",onClick:C,children:"刪除圖片"})})]}),e.jsxs("div",{className:"col-sm-8",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"title",className:"form-label",children:"標題"}),e.jsx("input",{name:"title",id:"title",type:"text",className:"form-control",placeholder:"請輸入標題",defaultValue:a.title,onChange:h})]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mb-3 col-md-6",children:[e.jsx("label",{htmlFor:"category",className:"form-label",children:"分類"}),e.jsx("input",{name:"category",id:"category",type:"text",className:"form-control",placeholder:"請輸入分類",defaultValue:a.category,onChange:h})]}),e.jsxs("div",{className:"mb-3 col-md-6",children:[e.jsx("label",{htmlFor:"unit",className:"form-label",children:"單位"}),e.jsx("input",{name:"unit",id:"unit",type:"text",className:"form-control",placeholder:"請輸入單位",defaultValue:a.unit,onChange:h})]})]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mb-3 col-md-6",children:[e.jsx("label",{htmlFor:"origin_price",className:"form-label",children:"原價"}),e.jsx("input",{name:"origin_price",id:"origin_price",type:"number",min:"0",className:"form-control",placeholder:"請輸入原價",defaultValue:a.origin_price,onChange:h})]}),e.jsxs("div",{className:"mb-3 col-md-6",children:[e.jsx("label",{htmlFor:"price",className:"form-label",children:"售價"}),e.jsx("input",{name:"price",id:"price",type:"number",min:"0",className:"form-control",placeholder:"請輸入售價",defaultValue:a.price,onChange:h})]})]}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"mb-3 col-md-6",children:[e.jsx("label",{htmlFor:"rate",className:"form-label",children:"商品評價"}),e.jsx("input",{name:"rate",id:"rate",type:"number",min:"0",max:"5",className:"form-control",placeholder:"請輸入評分 ( 0 非常不滿意～ 5 非常滿意）",defaultValue:a.rate,onChange:h})]})}),e.jsx("hr",{}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"description",className:"form-label",children:"產品描述"}),e.jsx("textarea",{name:"description",id:"description",className:"form-control",placeholder:"請輸入產品描述",defaultValue:a.description,onChange:h})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"content",className:"form-label",children:"說明內容"}),e.jsx("textarea",{name:"content",id:"content",className:"form-control",placeholder:"請輸入說明內容",defaultValue:a.content,onChange:h})]}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"form-check",children:[e.jsx("input",{name:"is_enabled",id:"is_enabled",className:"form-check-input",type:"checkbox",checked:!!a.is_enabled,onChange:h}),e.jsx("label",{className:"form-check-label",htmlFor:"is_enabled",children:"是否啟用"})]})})]})]})}),e.jsxs("div",{className:"modal-footer bg-black",children:[e.jsx("button",{type:"button",className:"btn btn-dark","data-bs-dismiss":"modal",onClick:t,children:"取消"}),r==="delete"?e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>v(a.id),children:"刪除"}):e.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>g(a.id),children:"確認"})]})]})})})},A=function({pagination:r,onChange:d}){const t=function(n,o){n.preventDefault(),d(o)};return e.jsx(e.Fragment,{children:e.jsx("nav",{"aria-label":"Page navigation example",children:e.jsxs("ul",{className:"pagination justify-content-center",children:[e.jsx("li",{className:"page-item",children:e.jsx("a",{className:`page-link ${r.has_pre?"bg-primary border-primary text-light":"disabled bg-primary border-primary text-secondary"}`,href:"#","aria-label":"Previous",onClick:n=>t(n,r.current_page-1),children:e.jsx("span",{"aria-hidden":"true",children:"«"})})}),Array.from({length:r.total_pages},(n,o)=>e.jsx("li",{className:"page-item",children:e.jsx("a",{className:`page-link ${r.current_page===o+1?"active bg-primary border-primary fw-bold text-light":"bg-primary border-primary text-light"}`,href:"#",onClick:m=>t(m,o+1),children:o+1})},o)),e.jsx("li",{className:"page-item",children:e.jsx("a",{className:`page-link ${r.has_next?"bg-primary border-primary text-light":"disabled bg-primary border-primary text-secondary"}`,href:"#","aria-label":"Next",onClick:n=>t(n,r.current_page+1),children:e.jsx("span",{"aria-hidden":"true",children:"»"})})})]})})})};export{$ as A,V as P,A as a,I as b,F as c};
