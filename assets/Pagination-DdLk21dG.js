import{j as e}from"./all-DAGqaRkU.js";import{a as b}from"./ProductsLoading-Cp4VV3v3.js";const _=function({openProductModal:n,INITIAL_TEMPLATE_PRODUCT_DATA:l}){return e.jsx("div",{className:"text-end mt-4",children:e.jsx("button",{className:"btn btn-primary mb-5",type:"button",onClick:()=>n("create",l.data),children:"建立新的產品"})})},F=function({products:n,openProductModal:l}){return e.jsxs(e.Fragment,{children:[e.jsx("thead",{className:"",children:e.jsxs("tr",{children:[e.jsx("th",{children:"產品名稱"}),e.jsx("th",{children:"原價"}),e.jsx("th",{children:"售價"}),e.jsx("th",{children:"是否啟用"}),e.jsx("th",{children:"查看細節"})]})}),e.jsx("tbody",{children:n.map(i=>e.jsxs("tr",{children:[e.jsx("td",{className:"align-middle",children:i.title}),e.jsx("td",{className:"align-middle",children:i.origin_price}),e.jsx("td",{className:"align-middle",children:i.price}),e.jsx("td",{className:`align-middle ${i.is_enabled?"":"text-secondary"}`,children:i.is_enabled?"已啟用":"未啟用"}),e.jsx("td",{className:"align-middle",children:e.jsxs("div",{className:"btn-group",role:"group","aria-label":"Basic example",children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>l("edit",i),children:"編輯"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>l("delete",i),children:"刪除"})]})})]},i.id))})]})},x="https://ec-course-api.hexschool.io/v2",f="eirene09",k=function({modalType:n,templateProductData:l,setTemplateProductData:i,closeProductModal:t,setIsProductsLoading:c,getProducts:h,Toast:o}){const p=async function(s,a=!0){a&&c(!0);const d={data:{...l,origin_price:Number(l.origin_price),price:Number(l.price),imagesUrl:[...l.imagesUrl.filter(r=>r!=="")]}};if(n==="create")try{const r=await b.post(`${x}/api/${f}/admin/product`,d);await h(!1),o.fire({icon:"success",title:"Create a new product successfully"})}catch{o.fire({icon:"error",title:"Fail to create a new product"})}finally{c(!1),t()}else try{const r=await b.put(`${x}/api/${f}/admin/product/${s}`,d);await h(!1),o.fire({icon:"success",title:"Update product successfully"})}catch{o.fire({icon:"error",title:"Fail to update product"})}finally{c(!1),t()}},m=function(s){const{name:a,value:d,checked:r,type:j}=s.target;i(function(C){return{...C,[a]:j==="checkbox"?r:d}})},u=function(s,a){i(function(d){const r=[...d.imagesUrl];return r[s]=a,a!==""&&s===r.length-1&&r.length<5&&r.push(""),a===""&&r.length>1&&r[r.length-1]===""&&r.pop(),{...d,imagesUrl:r}})},g=()=>{i(function(s){const a=[...s.imagesUrl];return a.push(""),{...s,imagesUrl:a}})},N=async function(s,a=!0){a&&c(!0);try{const d=await b.delete(`${x}/api/${f}/admin/product/${s}`);await h(!1),o.fire({icon:"success",title:"Delete product successfully"})}catch{o.fire({icon:"error",title:"Fail to delete product"})}finally{c(!1),t()}},y=()=>{i(function(s){const a=[...s.imagesUrl];return a.pop(),{...s,imagesUrl:a}})},v=async function(s){const a=s.target.files?.[0];if(!a){o.fire({icon:"error",title:"No file is selected"});return}try{const d=new FormData;d.append("file-to-upload",a);const r=await b.post(`${x}/api/${f}/admin/upload`,d);i(function(j){return{...j,imageUrl:r.data.imageUrl}})}catch{o.fire({icon:"error",title:"Failed to upload the file"})}};return e.jsx("div",{className:"modal-dialog modal-xl",children:e.jsxs("div",{className:"modal-content border-0",children:[e.jsxs("div",{className:`modal-header text-white 
            bg-${n==="delete"?"danger":"black"}`,children:[e.jsx("h5",{id:"productModalLabel",className:"modal-title",children:n==="create"?e.jsx("span",{children:"新增產品"}):n==="edit"?e.jsx("span",{children:"編輯產品"}):e.jsx("span",{children:"刪除產品"})}),e.jsx("button",{type:"button",className:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsx("div",{className:"modal-body bg-black text-white text-start",children:n==="delete"?e.jsxs("p",{className:"fs-4",children:["確定要刪除",e.jsx("span",{className:"text-red",children:l.title}),"嗎？"]}):e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-sm-4",children:[e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"file-to-upload",className:"form-label",children:"選擇上傳圖片"}),e.jsx("input",{className:"form-control",type:"file",name:"file-to-upload",id:"file-to-upload",accept:".jpg, .jpeg, .png",onChange:s=>v(s)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"imageUrl",className:"form-label",children:"輸入圖片網址"}),e.jsx("input",{type:"text",id:"imageUrl",name:"imageUrl",className:"form-control",placeholder:"請輸入圖片連結",defaultValue:l.imageUrl,onChange:m})]}),l.imageUrl&&e.jsx("img",{className:"img-fluid",src:l.imageUrl,alt:"主圖",referrerPolicy:"no-referrer"})]}),e.jsxs("div",{children:[l.imagesUrl.map(function(s,a){return e.jsxs("div",{children:[e.jsx("label",{htmlFor:"imageUrl",className:"form-label",children:"輸入圖片網址"}),e.jsx("input",{type:"text",className:"form-control",placeholder:`圖片網址${a+1}`,defaultValue:s,onChange:d=>u(a,d.target.value)}),s&&e.jsx("img",{className:"img-fluid",src:s,alt:`副圖${a+1}`,referrerPolicy:"no-referrer"})]},a)}),e.jsx("button",{className:"btn btn-primary btn-sm d-block w-100 mt-2",onClick:g,children:"新增圖片"})]}),e.jsx("div",{children:e.jsx("button",{className:"btn btn-danger btn-sm d-block w-100 mt-2",onClick:y,children:"刪除圖片"})})]}),e.jsxs("div",{className:"col-sm-8",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"title",className:"form-label",children:"標題"}),e.jsx("input",{name:"title",id:"title",type:"text",className:"form-control",placeholder:"請輸入標題",defaultValue:l.title,onChange:m})]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mb-3 col-md-6",children:[e.jsx("label",{htmlFor:"category",className:"form-label",children:"分類"}),e.jsx("input",{name:"category",id:"category",type:"text",className:"form-control",placeholder:"請輸入分類",defaultValue:l.category,onChange:m})]}),e.jsxs("div",{className:"mb-3 col-md-6",children:[e.jsx("label",{htmlFor:"unit",className:"form-label",children:"單位"}),e.jsx("input",{name:"unit",id:"unit",type:"text",className:"form-control",placeholder:"請輸入單位",defaultValue:l.unit,onChange:m})]})]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mb-3 col-md-6",children:[e.jsx("label",{htmlFor:"origin_price",className:"form-label",children:"原價"}),e.jsx("input",{name:"origin_price",id:"origin_price",type:"number",min:"0",className:"form-control",placeholder:"請輸入原價",defaultValue:l.origin_price,onChange:m})]}),e.jsxs("div",{className:"mb-3 col-md-6",children:[e.jsx("label",{htmlFor:"price",className:"form-label",children:"售價"}),e.jsx("input",{name:"price",id:"price",type:"number",min:"0",className:"form-control",placeholder:"請輸入售價",defaultValue:l.price,onChange:m})]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"description",className:"form-label",children:"產品描述"}),e.jsx("textarea",{name:"description",id:"description",className:"form-control",placeholder:"請輸入產品描述",defaultValue:l.description,onChange:m})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"content",className:"form-label",children:"說明內容"}),e.jsx("textarea",{name:"content",id:"content",className:"form-control",placeholder:"請輸入說明內容",defaultValue:l.content,onChange:m})]}),e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"form-check",children:[e.jsx("input",{name:"is_enabled",id:"is_enabled",className:"form-check-input",type:"checkbox",checked:!!l.is_enabled,onChange:m}),e.jsx("label",{className:"form-check-label",htmlFor:"is_enabled",children:"是否啟用"})]})})]})]})}),e.jsxs("div",{className:"modal-footer bg-black",children:[e.jsx("button",{type:"button",className:"btn btn-dark","data-bs-dismiss":"modal",onClick:t,children:"取消"}),n==="delete"?e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>N(l.id),children:"刪除"}):e.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>p(l.id),children:"確認"})]})]})})},$=function({modalType:n,productModalRef:l,templateProductData:i,setTemplateProductData:t,closeProductModal:c,setIsProductsLoading:h,getProducts:o,Toast:p}){return e.jsx("div",{className:"modal fade",id:"productModal",tabIndex:"-1","aria-labelledby":"productModal","aria-hidden":"true",ref:l,children:e.jsx(k,{modalType:n,templateProductData:i,setTemplateProductData:t,closeProductModal:c,setIsProductsLoading:h,getProducts:o,Toast:p})})},V=function({pagination:n,onChange:l}){const i=function(t,c){t.preventDefault(),l(c)};return e.jsx(e.Fragment,{children:e.jsx("nav",{"aria-label":"Page navigation example",children:e.jsxs("ul",{className:"pagination justify-content-center",children:[e.jsx("li",{className:"page-item",children:e.jsx("a",{className:`page-link ${n.has_pre?"bg-primary border-primary text-light":"disabled bg-primary border-primary text-secondary"}`,href:"#","aria-label":"Previous",onClick:t=>i(t,n.current_page-1),children:e.jsx("span",{"aria-hidden":"true",children:"«"})})}),Array.from({length:n.total_pages},(t,c)=>e.jsx("li",{className:"page-item",children:e.jsx("a",{className:`page-link ${n.current_page===c+1?"active bg-primary border-primary fw-bold text-light":"bg-primary border-primary text-light"}`,href:"#",onClick:h=>i(h,c+1),children:c+1})},c)),e.jsx("li",{className:"page-item",children:e.jsx("a",{className:`page-link ${n.has_next?"bg-primary border-primary text-light":"disabled bg-primary border-primary text-secondary"}`,href:"#","aria-label":"Next",onClick:t=>i(t,n.current_page+1),children:e.jsx("span",{"aria-hidden":"true",children:"»"})})})]})})})};export{_ as A,F as P,V as a,$ as b,k as c};
